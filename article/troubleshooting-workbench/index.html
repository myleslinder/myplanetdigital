<!DOCTYPE html>
<!--[if lt IE 8 ]>    <html lang="en" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en"> <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<script>
			 (new Image()).src = "/images/loading.gif";
		</script>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">
        <!--[if (lt IE 8) ]><meta http-equiv="refresh" content="0;url=/upgrade"> <![endif]-->
		
			<title>A brief guide to troubleshooting Workbench in Drupal | Myplanet</title>
		
		
			<meta name="description" content="A handy guide to some of the common problems encountered when trying to set up Workbench in Drupal.">
		
		<meta name="generator" content="DocPad v6.59.6" />
		<!--[if !IE]> -->
		<link  rel="stylesheet" href="/styles/main.css" />
		<!-- <![endif]-->

		<!--[if (lt IE 8)]>
			<link rel="stylesheet" href="/styles/site-ie7.css">
		<![endif]-->

		<!--[if (IE 8) | (IE 9)]>
		<link rel="stylesheet" href="/styles/site-ie8.css">
		<script src="/scripts/vendor/html5shiv.js"></script>
		<script>
			window.html5 = {
				'elements': 'section article footer',
				'shivCSS': false,
				'shivMethods': false
			}
			window.isIE8 = true;
		</script>
		<![endif]-->
		<link rel="icon" type="image/png" href="/favicon.png">
		
		
			
		
		<link rel="canonical" href="http://myplanet.io/article/troubleshooting-workbench/">
	</head>

	<body class="article">
		<div id="wrap">
			<h1 id="logo">
				<a href="/">Myplanet  | A brief guide to troubleshooting Workbench in Drupal</a>
			</h1>
			



	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	

	
		
		
		
		
	


<nav id="menu">
	<ul class="nav navbar-nav">
		
			

				
				
				
				<li class="home">
					<a  
						href="/"
						
							data-banner="&lt;h2&gt;We design and develop great web &amp; mobile products.&lt;/h2&gt;&lt;div class=&quot;banner-button&quot;&gt;&lt;a class=&quot;button&quot; data-attr=&quot;portfolio&quot; href=&quot;#portfolio&quot;&gt;See our &lt;strong&gt;Work &amp; Clients&lt;/strong&gt;&lt;/a&gt;&lt;/div&gt;"
						
						data-menu-colour="#f05a28"
						data-menu-doodle="bannerdoodle.png"
						data-tag="home"
					>
						<span>
							Home
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="company">
					<a  
						href="/tags/company/"
						
							data-banner="&lt;h2&gt;We provide UX &amp; technology solutions to build the right thing, fast. See what makes us tick.&lt;/h2&gt;"
						
						data-menu-colour="#f05a28"
						data-menu-doodle="banner-doodle-what-we-do.png"
						data-tag="company"
					>
						<span>
							What We Do
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="work">
					<a  
						href="/tags/work/"
						
							data-banner="&lt;h2&gt;We’ve partnered with amazing clients to deliver delightful products. Take a peek.&lt;/h2&gt;"
						
						data-menu-colour="#f05a28"
						data-menu-doodle="banner-doodle-what-we-do.png"
						data-tag="work"
					>
						<span>
							Our Work
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="careers">
					<a  
						href="/tags/careers/"
						
							data-banner="&lt;h2&gt;Join our merry band of designers, technologists, business folk and shameless pug lovers.&lt;/h2&gt;"
						
						data-menu-colour="#f05a28"
						data-menu-doodle="banner-doodle-what-we-do.png"
						data-tag="careers"
					>
						<span>
							Careers
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="contact">
					<a  data-attr=contact-link
						href="#contact"
						
							data-banner="&lt;h2&gt;The &quot;why&quot; we build - in discovery, we seek to understand what problem we are solving and for whom.&lt;/h2&gt;"
						
						data-menu-colour="#f16838"
						data-menu-doodle="bannerdoodle.png"
						data-tag="contact"
					>
						<span>
							Contact
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="design">
					<a  
						href="/tags/design/"
						
							data-banner="&lt;h2&gt;From pixels to process, here’s what we’ve been pondering in well-coordinated socks &amp; shoes.&lt;/h2&gt;"
						
						data-menu-colour="#5f5ca9"
						data-menu-doodle="banner-doodle-design.png"
						data-tag="design"
					>
						<span>
							Design
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="technology active">
					<a  
						href="/tags/technology/"
						
							data-banner="&lt;h2&gt;A good line of code is something beautiful to behold. And now, our thoughts on technology.&lt;/h2&gt;"
						
						data-menu-colour="#58c0a2"
						data-menu-doodle="banner-doodle-design.png"
						data-tag="technology"
					>
						<span>
							Technology
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
			

				
				
				
				<li class="community">
					<a  
						href="/tags/community/"
						
							data-banner="&lt;h2&gt;Meetups, hack nights, conferences, block parties. We’re socialites in geeks’ clothing.&lt;/h2&gt;"
						
						data-menu-colour="#ea3d67"
						data-menu-doodle="banner-doodle-design.png"
						data-tag="community"
					>
						<span>
							Community
						</span>
						<!--[if (IE 8) | (IE 9)]>
						<div class="menu-doodle"></div>
						<!-- <![endif]-->
					</a>
				</li>
			
		
	</ul>
</nav>

<!--[if (!IE) | (gte IE 10)]> -->
<div id="menu-toggle"><div id="menu-button">Show Menu</div></div>
<!-- <![endif]-->

			<div id="viewport">
				<section id="main" style="transition: none; -webkit-transition: none; position: absolute;">
					<div id="banner" class="">
						<div class="banner-text">
						
						</div>
					</div>

					<div class="landing-content" style="display:none">
    <section id="portfolio">
        <div class="flexslider">
            <ul class="slides">
                <li class="case-1">
                    <div class="case-studies">
                        <div class="case">
                            <h2>Our Expertise</h2>
                            <h3>We are passionate about creating great user experiences.</h3>
                            <p>By enabling network administrators to easily create network topology diagrams, the application significantly improved user satisfaction, task completion times and customer experience.</p>
                        </div>
                    </div>
                    <img src="/images/case-studies/slide-2.png" alt="" class="case-image">
                    <div class="case-button">
                        <a href="/article/savvis-topology/" class="button">View <strong>Case Study</strong></a>
                    </div>
                </li>
                <li class="case-2">
                    <div class="case-studies">
                        <div class="case">
                            <h2>Our Expertise</h2>
                            <h3>Building great web and mobile applications requires uncovering user truth.</h3>
                            <p>We practice user-centered design to uncover user truth and help businesses better connect with their customers. With over 60 million customers worldwide, Mitel and Myplanet worked together to build a local experience for their global customer base.</p>
                        </div>
                    </div>
                    <img src="/images/case-studies/slide-1.png" alt="" class="case-image slide-1">
                    <div class="case-button">
                        <a href="/article/mitel/" class="button">View <strong>Case Study</strong></a>
                    </div>
                </li>
                <li class="case-3">
                    <div class="case-studies">
                        <div class="case">
                            <h2>Our Expertise</h2>
                            <h3>We’re solving customer problems by building beautiful enterprise level software.</h3>
                            <p>Our videoconferencing-as-a-service solution, RelayRobin, provides a white labeled portal that customers will love. We empower organizations to stay competitive by helping them get to market faster.</p>
                        </div>
                    </div>
                    <img src="/images/case-studies/slide-3.png" alt="" class="case-image">
                    <div class="case-button">
                        <a href="mailto:hello@myplanet.io" class="button">Contact for<strong> Demo</strong></a>
                    </div>
                </li>
            </ul>
        </div>
    </section>
    <section id="clients">
        <div class="clients-block">
            <h2>Our Clients</h2>
            <ul class="clients-list">
                <li><img src="/images/clients/centurylink-bw.png" width="145" style="margin-top: -15px;" alt="CenturyLink"></li>
                <li><img src="/images/clients/esri-bw.png" width="145" style="margin-top: -16px;" alt="Esri Canada"></li>
                <li><img src="/images/clients/telx-bw.png" width="140" style="margin-top: -15px;" alt="TelX"></li>
                <li><img src="/images/clients/lassonde-bw.png" width="65px" style="margin-top: -32px;" alt="Lassonde"></li>
                <li><img src="/images/clients/rcm-bw.png" width="115px" style="margin-top: -30px;" alt="The Royal Conservatory"></li>
                <li><img src="/images/clients/spartannash-bw.png" width="145px" style="margin-top: -17px;" alt="SpartanNash"></li>
                <li><img src="/images/clients/hcoc-bw.png" width="170px" style="margin-top: -14px;" alt="Health Council of Canada"></li>
                <li><img src="/images/clients/mitel-bw.png" width="115px" style="margin-top: -17px;" alt="Mitel"></li>
                <li><img src="/images/clients/savvis-bw.png" width="120px" style="margin-top: -10px;" alt="Savvis"></li>
                <li><img src="/images/clients/solarwinds-bw.png" width="140px" style="margin-top: -16px;" alt="Solarwinds"></li>
                <li><img src="/images/clients/smartcentres-bw.png" width="89px" style="margin-top: -25px;" alt="SmartCentres"></li>
                <li><img src="/images/clients/wyndham-bw.png" width="130px" style="margin-top: -11px;" alt="Wyndham"></li>
            </ul>
        </div>
    </section>
    <section id="testimonial">
        <div class="flexslider">
            <ul class="slides">
                <li class="client-quote">
                    <p>The Myplanet team helped us refine and update the front-end of our web application. Their research and user testing allowed us to craft a design that not only looks great but that meets the needs of our discerning application users.</p>
                    <div class="client-title">Annie Welch, <strong>UX Manager, SolarWinds</strong></div>
                </li>
                <li class="client-quote">
                    <p>We went with Myplanet because we wanted to work with an agile agency. I was very impressed with their commitment to the process. They helped educate us on a version of agile that felt authentic to what agile is. They truly practice it.</p>
                    <div class="client-title">Kiel Jared, <strong>Creative Director, Mitel</strong></div>
                </li>
                <li class="client-quote">
                    <p>Myplanet has been my go-to resource for new product development – their combination of user experience, design and development help us identify and validate product concepts, then quickly bring those new offerings to market.</p>
                    <div class="client-title">Manager of User Experience Design, <strong>CenturyLink</strong></div>
                </li>
                <li class="client-quote">
                    <p>The entire team at Telx was really impressed with the workshop Myplanet delivered and facilitated. It’s also impressive when you are working with a vendor that immediately gets our technologies and can gain the trust of our participants. You made me look good, and for that I am grateful.</p>
                    <div class="client-title">Andrew Baird, <strong>Director of Product Management, Telx</strong></div>
                </li>
                <li class="client-quote">
                    <p>The expert skills that the Myplanet team brought to the project resulted in the development of a more robust site, and delivered much faster than we could have achieved in-house. I also appreciate the ongoing relationship with the team who provide both support and insight into new technology and trends that we might want to adopt.</p>
                    <div class="client-title">Colleen Raymond, <strong>Manager of Web & Database Marketing, Esri Canada</strong></div>
                </li>
            </ul>
        </div>
    </section>
    <section id="learn-more">
        <div class="info">
            <h2>Our Approach</h2>
            <p>Our unique process combines elements of user-centered design, Lean Startup, and Agile methodologies.</p>
            <a href="/article/our-approach/">Learn <strong>More</strong></a>
        </div>
        <div class="info">
            <h2>Our Offerings & Services</h2>
            <p>We specialize in cross-device applications, web experience management and web portal solutions.</p>
            <a href="/article/our-offerings/">Learn <strong>More</strong></a>
        </div>
        <div class="info">
            <h2>We’re Different</h2>
            <p>Our engagements are uniquely tailored to help clients uncover user truths and drive rapid product development.</p>
            <a href="/article/what-we-do/">Learn <strong>More</strong></a>
        </div>
    </section>
</div>

					<div class="main-wrap" style="position: relative; ">
						
						<script src="/scripts/vendor/isotope-beta2.pkgd.min.js"></script>
						<script>
						
							window.initializeTiles = function(){
						
						    (function tilesImmediate () {
  'use strict';

  var loadingGif;

  window.tiles = new Isotope( '.main-wrap', {
    itemSelector: '.tile',
    filter: '.visible',
    masonry: {
      columnWidth: '.grid-size'
    },
    transitionDuration: 0,
    visibleStyle: {},
    hiddenStyle: {}
  });

  loadingGif = new Image();
  loadingGif.src = "/images/loading.gif";
  loadingGif.onload = function () {
    if('ontouchstart' in window) {
        var els = document.querySelectorAll('.tile'),
            len = els.length;
        while(len--) {
            els[len].style.opacity = 1;
        }
    }
  };
}());

						
							};
						
						</script>
					</div>
					<div class="loading-overlay-tiles" >
						<div class="loading-spinner"></div>
					</div>
					<footer class="footer" id="contact">
	<div class="inner">
		<div class="block">
			<div class="vcard">
				<span class="fn org">Myplanet</span>
				<div class="adr">
					<span class="street-address">252 Adelaide St E</span>
					<span class="locality">Toronto</span>,<span class="region">Ontario</span>, <span class="country">Canada</span>
				</div>
				<p class="tel">1-866-232-7456</p>
				<a href="http://myplanet.io" class="url">Myplanet</a>
			</div>
			<div class="contact-info">
				<span class="in-touch">Get In Touch</span>
				<div class="email-us">
					<span>e-mail us</span>
					<p><a href="mailto:hello@myplanet.io">hello@myplanet.io</a></p>
				</div>
				<div class="call-us">
					<span>call us</span>
					<p>1-866-232-7456</p>
				</div>
			</div>
			<ul class="social-media-footer">
				<li><a class="twitter" href="http://twitter.com/myplanetHQ" target="_blank">Twitter</a></li>
				<li><a class="facebook" href="http://www.facebook.com/myplanetHQ" target="_blank">Facebook</a></li>
				<li><a class="dribbble" href="http://dribbble.com/myplanet" target="_blank">Dribbble</a></li>
				<li><a class="drupal" href="http://drupal.org/node/1121200" target="_blank">Drupal</a></li>
				<li><a class="linkedin" href="http://www.linkedin.com/company/701891" target="_blank">Linkedin</a></li>
			</ul>
		</div>
		<div class="block addresses">
			<div class="address toronto">
				<span>Toronto</span>
				<a data-long-lat="43.65163,-79.37104" href="http://maps.google.com/?q=252 Adelaide St E, Toronto, ON, Canada" target="_blank">
					<span>252 Adelaide St E</span>
					<span>Toronto, Ontario</span>
					<span>M5A 1N1</span>
				</a>
			</div>
			<div class="address vancouver">
				<span>Vancouver</span>
				<a data-long-lat="49.28411,-123.11223" href="http://maps.google.com/?q=312-510 West Hastings, Vancouver, BC, Canada" target="_blank">

					<span>312-510 West Hastings</span>
					<span>Vancouver, BC</span>
					<span>V6B 1L8</span>
				</a>
			</div>
			<div class="address chernihiv">
				<span>Chernihiv</span>
				<a data-long-lat="51.497299,31.311979" href="http://maps.google.com/?q=21a Voiniv-Internatsionalistiv St, Chernihiv, Ukraine" target="_blank">
					<span>21a Voiniv-Internatsionalistiv St</span>
					<span>Chernihiv, Ukraine</span>
					<span>14000</span>
				</a>
			</div>
			<div class="address chicago">
				<span>Chicago</span>
				<a data-long-lat="41.881567,-87.633187" href="http://maps.google.com/?q=155 North Wacker Dr. Chicago, IL" target="_blank">
					<span>155 North Wacker Dr. Suite 4250</span>
					<span>Chicago, IL</span>
					<span>60606</span>
				</a>
			</div>
		</div>
		<div class="privacy">
			&copy; 2014 Myplanet Internet Solutions Ltd. All Rights Reserved. <a href="/privacy/">Privacy Policy</a>
		</div>
	</div>
</footer>

				</section>
				<article id="article" style="position: static; margin-left: 100%;">
					<div id="article-inner"  class="reveal revealed">
						
						




	








	
	
	
	









<div class="article-banner" style="background-image: url(/images/default-covers/9.jpg);" >
	<img src="/images/default-covers/9.jpg" style="display:none; visibility:hidden;" />
</div>
<div class="article-title">
	
	<h1>
		
			
			<span>Troubleshooting </span><span>Workbench in Drupal</span>
		
	</h1>
	
</div>




<div class="article-body" data-tag="technology">
	<div class="article-info">

		


		


		

		
			<div class="author-info">

				

				
					
						<span class="author-name">Anna Sunko</span>
					
				


				
				

			</div>
		

		
		
			<ul class="article-tags">
				
					<li><a href="/tags/technology/">technology</a></li>
				
			</ul>
		
	</div>


	

	
		<div class="article-content">
			<h2 id="a-handy-guide-to-some-of-the-common-problems-encountered-when-trying-to-set-up-workbench-in-drupal-">A handy guide to some of the common problems encountered when trying to set up Workbench in Drupal.</h2>
<h3 id="intro-to-workbench">Intro to Workbench</h3>
<p>Before explaining the problems we&#39;ve encountered while implementing Workbench, I&#39;d like to describe the use-case for Workbench and list its major features.</p>
<p>Content administrators need a friendly interface to quickly find, sort, and modify content. But the Drupal content management interface, while functional, lacks some of the convenience that Workbench offers. It&#39;s also often desirable to distinguish between users and/or roles which have different permissions through the publishing workflow. For example, users in one role may need to moderate revisions of only their own content while users of another role may need to manage all revisions and have authority to publish. Drupal&#39;s core modules don&#39;t enable this publishing workflow exactly, though Drupal supports content revisions. Based on this concept of revisions, a package of modules were created to flesh out this functionality and provide content administrators a robust content management and publishing interface -- that package includes Workbench, Workbench Access, and Workbench Moderation.</p>
<p>After enabling Workbench module, any user with &quot;Access My Workbench&quot; permission gets access to a new admin-menu item called &quot;My Workbench&quot;, and content owned or modified by the current user is available in sub-menu item called &quot;My Content&quot;.</p>
<p>Drupal provides permissions for adding, editing, and deleting content -– that is to add/edit/delete one&#39;s own content as well as another&#39;s content. Workbench Access module extends these permissions to provide editorial access controls based on what Workbench calls &quot;sections&quot;. Sections of content correspond to the hierarchal placement of that content via taxonomy or menu and users can be assigned to specific sections so they can add or moderate content within them. While creating and editing content, a user can associate their content to a specific section and Workbench Access module then helps control who can collaborate on that piece of content -- who can see, edit, approve, publish, etc.</p>
<p>The Workbench Access module settings page provides the ability to indicate which Drupal hierarchical data structures will be used as sections and for which content types Workbench Access restrictions will be imposed. As well, this module provides a UI so you can assign users or roles to specific sections.</p>
<p>In Drupal, every content revision is in one of two states: published or unpublished. The Workbench Moderation module provides more states for unpublished content so it can be reviewed and approved before being published. For a content type to support moderation states you need to &quot;Enable moderation of revisions&quot; on the content type settings page, and disable immediate publication of content on its creation. On the settings page of this module you can specify additional moderation states and transitions but the standards are &quot;draft&quot;, &quot;needs review&quot;, and &quot;published&quot;. Workbench Moderation module generates separate permissions based on all transitions to control which roles/users can transition the content from one state to another. For the &quot;node/%nid&quot; page, the modules provide an additional tab called &quot;Moderate&quot; where node revision history is available and you can change moderation state for the active revision.</p>
<h3 id="are-you-using-workbench-and-field-collection-modules-">Are you using Workbench and Field Collection modules?</h3>
<p>First, regardless of Workbench integration, we had to solve a problem with Field Collection module whereby fields of the field collection type couldn&#39;t be deleted thoroughly -- i.e: if you create a field of the field collection type and then delete it, tables containing <em>values</em> of this field were removed (data table and revision table), but meta-information <em>about</em> the deleted field still exists in <code>field_config_instance</code>, <code>field_config</code> and <code>field_collection_item</code> tables.</p>
<p>This problem led to errors while running cron –- the system would encounter information about the deleted field collection field in <code>field_config_instance</code>, then would try to form an instance of that field, then of course encounter errors. To solve this problem we wrote a <code>hook_update</code> to delete all artifacts of the offending field collection fields.</p>
<h3 id="-hook_update-code"><code>hook_update</code> code</h3>
<pre><code>$instances = field_read_instances(array(&#39;deleted&#39; =&gt; 1),
             array(&#39;include_deleted&#39; =&gt; 1));
// Array of fields that should be deleted
$deleted = array(&#39;field_some_field_collection_field&#39;);
foreach ((array) $instances as $key =&gt; $instance) {
    if (in_array($instance[&#39;field_name&#39;], $deleted)) {
        // Removing record related with field
        // from field_config_instance table
        field_purge_instance($instance);
        $field = field_info_field_by_id($instance[&#39;field_id&#39;]);
        // Removing record related with field
        // from field_config table
        field_purge_field($field);
        // Removing record related with field
        // from field_collection_item table
        db_delete(&#39;field_collection_item&#39;)-&gt;condition(
          &#39;field_name&#39;, $instance[&#39;field_name&#39;])-&gt;execute();
    }
}
</code></pre><p>Expected behavior of nodes moderated via Workbench workflow:</p>
<ul>
<li>after saving draft of node, none of changes should appear on the &quot;View published&quot; page</li>
<li>after saving draft of node, all changes should be saved as a part of draft and could be changed within the draft</li>
<li>the draft could be published and all its changes would be shown on the &quot;View published&quot; page</li>
</ul>
<p>But the field collection module, including version &quot;field_collection 7.x-1.0-beta4&quot;, doesn&#39;t support field revisions. This means that when a user clicks to save a draft of their node, all field collection fields associated with that node are published immediately (without respecting Workbench&#39;s moderation status). The full implementation of a revision system for field collection has existed since version &quot;7.x-1.0-beta5&quot;, and at the time of this writing it is the current stable version of this module.</p>
<p>However, while using &quot;7.x-1.0-beta5&quot; version of the module, a serious problem was discovered wherein a node would simultaneously exist in a published and unpublished state -- go figure!?! After deleting one of the multiple field collection fields and moving node to published state using Workbench&#39;s &quot;Moderate&quot; tab, the node status in the node table became &quot;unpublished&quot;, while the Workbench Moderation module would add a record that the node had been published to its own table. We were able to fix it with this <a href="http://drupal.org/files/field_collection_with_workbench_moderation-1807460-1.patch" target="_blank">patch</a>.</p>
<h3 id="workbench-moderation-with-views-3-5-and-content-access-modules">Workbench moderation with Views 3.5 and Content Access modules</h3>
<p>The specificity of using these modules together is that their combination leads to a problem of excluding unpublished nodes from results of Workbench views &quot;My Content&quot;, &quot;My Drafts&quot;, &quot;Needs Review&quot; for the user who has permissions for creating and editing unpublished content, except for cases when the user has the &#39;Bypass content access control&#39; permission set. It means that the user creates a node draft and can&#39;t find it on &quot;My Drafts&quot; page.</p>
<p>The description of this problem can be found <A href="http://drupal.org/node/1925096" target="_blank">here</a>. We were able to solve this problem by installing an additional module &#39;<a href="http://drupal.org/project/view_unpublished" target="_blank">view_unpublished</a>&#39;.</p>
<h3 id="symptom">Symptom</h3>
<p>A user who has created drafts of nodes cannot find said drafts on Workbench&#39;s &quot;My Drafts&quot; page.</p>
<h3 id="explanation-of-cause">Explanation of Cause</h3>
<p>When using these versions of the modules together (Workbench Moderation, Views 3.5, and Content Access), unpublished nodes would be excluded from the result set while viewing &quot;My Content&quot;, &quot;My Drafts&quot;, &quot;Needs Review&quot; by any user who has permissions for creating and editing unpublished content -- except for cases when a user may have &#39;Bypass content access control&#39; permission.</p>
<p>Tip: <em>Read that again!</em></p>
<h4 id="solution">Solution</h4>
<p>A complete description of this problem can be found at <a href="http://drupal.org/node/1925096" target="_blank">drupal.org/node/1925096</a>. We were able to solve this problem by installing and configuring the <a href="http://drupal.org/project/view_unpublished" target="_blank">view_unpublished</a> module.</p>
<h3 id="workbench-moderation-and-scheduler-modules">Workbench Moderation and Scheduler modules</h3>
<p>The Scheduler module doesn&#39;t play nice with the Workbench Moderation module. When Scheduler publishes or unpublishes a node on a specified date it changes the node status in the &quot;node&quot; table. <em>Period.</em></p>
<p>For example, if a node was in an unpublished state and the Scheduler module publishes it, the node page will display a discrepancy. The Node module will show that node is published but the Workbench Moderation module will display its previous state as &quot;draft&quot; or &quot;needs review&quot;.</p>
<p>If you are using Workbench Moderation and Scheduler together, it&#39;s essential that Workbench be informed of this change. When a node status is changed from &quot;draft&quot; to &quot;published&quot; or vice versa, a new record must be added to the &quot;workbench_moderation_node_history&quot;. For Workbench Moderation module to interact with Scheduler module you should install <a href="http://drupal.org/project/scheduler_workbench" target="_blank">Scheduler Workbench Integration</a> module.</p>
<h3 id="workbench-moderation-and-views-modules">Workbench moderation and Views modules</h3>
<p>The expected behavior of Views while displaying information about a node on the node view page is:</p>
<ul>
<li>On the &quot;View Draft&quot; page (<code>node/%nid/draft</code>), Views should display data from current unpublished revision</li>
<li>On the <code>node/%nid</code> page, Views should display data from the current published revision (if there is one, otherwise it should display data from current unpublished revision -- same as the &quot;View Draft&quot; page)</li>
<li>On the <code>node/%nid/revisions/%revision_id/view</code> page, Views should display data from revision passed as <code>%revision_id</code> in the url.</li>
</ul>
<p>For Views to fulfill the above requirements:</p>
<ul>
<li>Change the base table of the view from &quot;node&quot; to &quot;node_revision&quot; (when creating a view on <code>admin/structure/views/add</code> page there is a field called &quot;Show&quot; where we can choose the instance to be shown in the view. For our purposes, set this field to &quot;Content revisions&quot;)</li>
<li>The view should derive content from fields revision tables (marked as &quot;Content historical data&quot;)</li>
</ul>
<!-- * Set an argument for the view to get argument from current "vid", not from "nid" (in the "Contextual filters" area add "Content revision: Vid" argument). The type of this argument should be "PHP Code". In the "PHP contextual filter code" set custom a function that determines the correct node revision vid:

        function get_node_revision_by_nid($nid = NULL) {
            if (arg(0) == 'node' && $nid == NULL) {
                $nid = arg(1);
            }
            if (is_numeric($nid)) {
                $node = node_load($nid);
                if (!empty($node)) {
                    // getting vid on the
                    // node/%nid page
                    $vid = $node->vid;
                    if (arg(2) == 'draft' &&
                            isset($node->workbench_moderation['current']->vid) &&
                            ($node->vid != $node->workbench_moderation['current']->vid)) {
                        // getting vid on the node/%nid/draft page
                        $vid = $node->workbench_moderation['current']->vid;
                    }
                    if (arg(2) == 'revisions' && is_numeric(arg(3))) {
                        // getting vid on the
                        // node/%nid/revisions/%revision_id/view page
                        $vid = arg(3);
                    }
                }
                return $vid;
            }
        } -->

			
			<div class="article-footer">
				<div class="footer-doodle technology"></div>
			</div>
		</div>
	

	<div id="disqus_thread"></div>
<script>
	(function(){
		window.disqus_shortname = 'myplanetsite';
		window.disqus_developer = '1';
		window.disqus_url = '/article/troubleshooting-workbench';
		window.disqus_identifier = 'article-troubleshooting-workbench';
		window.disqus_title = 'A brief guide to troubleshooting Workbench in Drupal';
		if ( window.DISQUS ) {
			return DISQUS.reset({
				reload: true,
				config: function () {
					this.page.identifier = window.disqus_identifier;
					this.page.url = window.disqus_url;
					this.page.title = window.disqus_title;
				}
			});
		}
		else {
		  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		}
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

						
					</div>
					<div class="loading-overlay" style="display:none;">
						<div class="loading-spinner"></div>
					</div>
                    <footer class="footer" id="contact">
	<div class="inner">
		<div class="block">
			<div class="vcard">
				<span class="fn org">Myplanet</span>
				<div class="adr">
					<span class="street-address">252 Adelaide St E</span>
					<span class="locality">Toronto</span>,<span class="region">Ontario</span>, <span class="country">Canada</span>
				</div>
				<p class="tel">1-866-232-7456</p>
				<a href="http://myplanet.io" class="url">Myplanet</a>
			</div>
			<div class="contact-info">
				<span class="in-touch">Get In Touch</span>
				<div class="email-us">
					<span>e-mail us</span>
					<p><a href="mailto:hello@myplanet.io">hello@myplanet.io</a></p>
				</div>
				<div class="call-us">
					<span>call us</span>
					<p>1-866-232-7456</p>
				</div>
			</div>
			<ul class="social-media-footer">
				<li><a class="twitter" href="http://twitter.com/myplanetHQ" target="_blank">Twitter</a></li>
				<li><a class="facebook" href="http://www.facebook.com/myplanetHQ" target="_blank">Facebook</a></li>
				<li><a class="dribbble" href="http://dribbble.com/myplanet" target="_blank">Dribbble</a></li>
				<li><a class="drupal" href="http://drupal.org/node/1121200" target="_blank">Drupal</a></li>
				<li><a class="linkedin" href="http://www.linkedin.com/company/701891" target="_blank">Linkedin</a></li>
			</ul>
		</div>
		<div class="block addresses">
			<div class="address toronto">
				<span>Toronto</span>
				<a data-long-lat="43.65163,-79.37104" href="http://maps.google.com/?q=252 Adelaide St E, Toronto, ON, Canada" target="_blank">
					<span>252 Adelaide St E</span>
					<span>Toronto, Ontario</span>
					<span>M5A 1N1</span>
				</a>
			</div>
			<div class="address vancouver">
				<span>Vancouver</span>
				<a data-long-lat="49.28411,-123.11223" href="http://maps.google.com/?q=312-510 West Hastings, Vancouver, BC, Canada" target="_blank">

					<span>312-510 West Hastings</span>
					<span>Vancouver, BC</span>
					<span>V6B 1L8</span>
				</a>
			</div>
			<div class="address chernihiv">
				<span>Chernihiv</span>
				<a data-long-lat="51.497299,31.311979" href="http://maps.google.com/?q=21a Voiniv-Internatsionalistiv St, Chernihiv, Ukraine" target="_blank">
					<span>21a Voiniv-Internatsionalistiv St</span>
					<span>Chernihiv, Ukraine</span>
					<span>14000</span>
				</a>
			</div>
			<div class="address chicago">
				<span>Chicago</span>
				<a data-long-lat="41.881567,-87.633187" href="http://maps.google.com/?q=155 North Wacker Dr. Chicago, IL" target="_blank">
					<span>155 North Wacker Dr. Suite 4250</span>
					<span>Chicago, IL</span>
					<span>60606</span>
				</a>
			</div>
		</div>
		<div class="privacy">
			&copy; 2014 Myplanet Internet Solutions Ltd. All Rights Reserved. <a href="/privacy/">Privacy Policy</a>
		</div>
	</div>
</footer>

				</article>
			</div>
		</div>
		<div id="back">
			<a href="/" data-attr="back">Back</a>
		</div>
		<!--[if (IE 8) | (IE 9)]>
		<script src="/scripts/vendor/jquery-1.11.0.min.js"></script>
		<script src="/scripts/main-ie8.js"></script>
		<script src="/scripts/menu-ie8.js"></script>
		<script src="/scripts/vendor/jquery.flexslider-min.js"></script>
		<script src="/scripts/modules/slider.js"></script>
		<![endif]-->
		<!--[if !IE]> -->
		
			<script src="/scripts/all.js"></script>
		
		<!-- <![endif]-->
		
		<script >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-16401713-2');
ga('send', 'pageview');</script>
		<script>
			(function (tos) {
			  window.setInterval(function () {
			    tos = (function (t) {
			      return t[0] == 50 ? (parseInt(t[1]) + 1) + ':00' : (t[1] || '0') + ':' + (parseInt(t[0]) + 10);
			    })(tos.split(':').reverse());
			    ga('send', 'event', 'Time', 'Log', tos, {'nonInteraction': true});
			  }, 10000);
			})('00');
		</script>
		


	</body>
</html>
